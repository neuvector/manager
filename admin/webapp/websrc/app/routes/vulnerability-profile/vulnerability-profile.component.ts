import { Component, OnInit } from '@angular/core';
import {
  CfgType,
  VulnerabilityProfile,
  VulnerabilityProfileEntry,
} from '@common/types';
import { VulnerabilityProfileService } from '@routes/vulnerability-profile/vulnerability-profile.service';

@Component({
  selector: 'app-vulnerability-profile',
  templateUrl: './vulnerability-profile.component.html',
  styleUrls: ['./vulnerability-profile.component.scss'],
})
export class VulnerabilityProfileComponent implements OnInit {
  vulnerabilityProfiles!: {
    entries: VulnerabilityProfileEntry[];
    cfg_type: CfgType;
    domains: string[];
  };
  loaded = false;

  constructor(
    private vulnerabilityProfileService: VulnerabilityProfileService
  ) {}

  ngOnInit(): void {
    this.vulnerabilityProfileService
      .initVulnerabilityProfile()
      .subscribe(profiles => {
        this.vulnerabilityProfiles = {
          entries: profiles.profiles.entries,
          cfg_type: profiles.profiles.cfg_type!,
          domains: profiles.domains,
        };
        this.loaded = true;
      });
  }
}
